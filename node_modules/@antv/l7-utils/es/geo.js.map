{"version":3,"sources":["../src/geo.ts"],"names":["degreesToRadians","radiansToLength","originShift","Math","PI","extent","data","dataExtent","Infinity","forEach","item","coordinates","caculExtent","coords","Array","isArray","coord","tranfrormCoord","cb","transform","map","lngLatToMeters","lnglat","validate","accuracy","enable","decimal","validateLngLat","lng","lat","x","y","log","tan","Number","toFixed","length","metersToLngLat","meters","atan","exp","undefined","longitude","Error","latitude","aProjectFlat","maxs","max","min","scale","d","a","b","c","floor","unProjectFlat","px","pow","E","amap2Project","r","Rg","Tg","lnglatDistance","coordinates1","coordinates2","units","dLat","dLon","lat1","lat2","sin","cos","atan2","sqrt","project","earthRadius","padBounds","bufferRatio","heightBuffer","abs","widthBuffer","boundsContains","b1","b2","bBoxToBounds","normalize","v","len","calDistance","p1","p2","dotMul","v1","v2","getMod","calAngle","acos","getAngle","flow","time","originVec2","totalDis","path","i","dis","direct","rotation","lastRotation","push","start","end","duration","point"],"mappings":"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","sourcesContent":["import {\n  BBox,\n  Coord,\n  degreesToRadians,\n  isObject,\n  radiansToLength,\n  Units,\n} from '@turf/helpers';\n\nexport type IBounds = [[number, number], [number, number]];\ninterface ILngLat {\n  lng: number;\n  lat: number;\n}\ninterface IPoint {\n  x: number;\n  y: number;\n}\nconst originShift = (2 * Math.PI * 6378137) / 2.0;\ntype Point = number[];\n/**\n * 计算地理数据范围\n * @param {dataArray} data 地理坐标数据\n * @return {Array} dataExtent\n */\nexport function extent(data: any[]): BBox {\n  const dataExtent: BBox = [Infinity, Infinity, -Infinity, -Infinity];\n  data.forEach((item) => {\n    const { coordinates } = item;\n    caculExtent(dataExtent, coordinates);\n  });\n  return dataExtent;\n}\nfunction caculExtent(dataExtent: BBox, coords: any[]) {\n  if (Array.isArray(coords[0])) {\n    coords.forEach((coord) => {\n      caculExtent(dataExtent, coord);\n    });\n  } else {\n    if (dataExtent[0] > coords[0]) {\n      dataExtent[0] = coords[0];\n    }\n    if (dataExtent[1] > coords[1]) {\n      dataExtent[1] = coords[1];\n    }\n    if (dataExtent[2] < coords[0]) {\n      dataExtent[2] = coords[0];\n    }\n    if (dataExtent[3] < coords[1]) {\n      dataExtent[3] = coords[1];\n    }\n  }\n  return dataExtent;\n}\n\nexport function tranfrormCoord(data: any[], cb: (item: any[]) => any) {\n  return transform(data, cb);\n}\nfunction transform(item: any[], cb: (item: any[]) => any): any {\n  if (Array.isArray(item[0])) {\n    return item.map((coord) => {\n      return transform(coord, cb);\n    });\n  }\n  return cb(item);\n}\nexport function lngLatToMeters(lnglat: Point): Point;\nexport function lngLatToMeters(\n  lnglat: Point,\n  validate: boolean = true,\n  accuracy = { enable: true, decimal: 1 },\n) {\n  lnglat = validateLngLat(lnglat, validate);\n  const lng = lnglat[0];\n  const lat = lnglat[1];\n  let x = (lng * originShift) / 180.0;\n  let y =\n    Math.log(Math.tan(((90 + lat) * Math.PI) / 360.0)) / (Math.PI / 180.0);\n  y = (y * originShift) / 180.0;\n  if (accuracy.enable) {\n    x = Number(x.toFixed(accuracy.decimal));\n    y = Number(y.toFixed(accuracy.decimal));\n  }\n  return lnglat.length === 3 ? [x, y, lnglat[2]] : [x, y];\n}\n\nexport function metersToLngLat(meters: Point, decimal = 6) {\n  const x = meters[0];\n  const y = meters[1];\n  let lng = (x / originShift) * 180.0;\n  let lat = (y / originShift) * 180.0;\n  lat =\n    (180 / Math.PI) *\n    (2 * Math.atan(Math.exp((lat * Math.PI) / 180.0)) - Math.PI / 2.0);\n  if (decimal !== undefined && decimal !== null) {\n    lng = Number(lng.toFixed(decimal));\n    lat = Number(lat.toFixed(decimal));\n  }\n  return meters.length === 3 ? [lng, lat, meters[2]] : [lng, lat];\n}\nexport function longitude(lng: number) {\n  if (lng === undefined || lng === null) {\n    throw new Error('lng is required');\n  }\n\n  // lngitudes cannot extends beyond +/-90 degrees\n  if (lng > 180 || lng < -180) {\n    lng = lng % 360;\n    if (lng > 180) {\n      lng = -360 + lng;\n    }\n    if (lng < -180) {\n      lng = 360 + lng;\n    }\n    if (lng === 0) {\n      lng = 0;\n    }\n  }\n  return lng;\n}\nexport function latitude(lat: number) {\n  if (lat === undefined || lat === null) {\n    throw new Error('lat is required');\n  }\n\n  if (lat > 90 || lat < -90) {\n    lat = lat % 180;\n    if (lat > 90) {\n      lat = -180 + lat;\n    }\n    if (lat < -90) {\n      lat = 180 + lat;\n    }\n    if (lat === 0) {\n      lat = 0;\n    }\n  }\n  return lat;\n}\nexport function validateLngLat(lnglat: Point, validate: boolean): Point {\n  if (validate === false) {\n    return lnglat;\n  }\n\n  const lng = longitude(lnglat[0]);\n  let lat = latitude(lnglat[1]);\n\n  // Global Mercator does not support latitudes within 85 to 90 degrees\n  if (lat > 85) {\n    lat = 85;\n  }\n  if (lat < -85) {\n    lat = -85;\n  }\n  return lnglat.length === 3 ? [lng, lat, lnglat[2]] : [lng, lat];\n}\nexport function aProjectFlat(lnglat: number[]) {\n  const maxs = 85.0511287798;\n  const lat = Math.max(Math.min(maxs, lnglat[1]), -maxs);\n  const scale = 256 << 20;\n  let d = Math.PI / 180;\n  let x = lnglat[0] * d;\n  let y = lat * d;\n  y = Math.log(Math.tan(Math.PI / 4 + y / 2));\n\n  const a = 0.5 / Math.PI;\n  const b = 0.5;\n  const c = -0.5 / Math.PI;\n  d = 0.5;\n  x = scale * (a * x + b);\n  y = scale * (c * y + d);\n  return [Math.floor(x), Math.floor(y)];\n}\nexport function unProjectFlat(px: number[]): [number, number] {\n  const a = 0.5 / Math.PI;\n  const b = 0.5;\n  const c = -0.5 / Math.PI;\n  let d = 0.5;\n  const scale = 256 << 20;\n  let [x, y] = px;\n  x = (x / scale - b) / a;\n  y = (y / scale - d) / c;\n  y = (Math.atan(Math.pow(Math.E, y)) - Math.PI / 4) * 2;\n  d = Math.PI / 180;\n  const lat = y / d;\n  const lng = x / d;\n  return [lng, lat];\n}\n\nexport function amap2Project(lng: number, lat: number): [number, number] {\n  const r = 85.0511287798;\n  const Rg = Math.PI / 180;\n  const Tg = 6378137;\n\n  lat = Math.max(Math.min(r, lat), -r);\n  lng *= Rg;\n  lat *= Rg;\n  lat = Math.log(Math.tan(Math.PI / 4 + lat / 2));\n  return [lng * Tg, lat * Tg];\n}\n\nexport function lnglatDistance(\n  coordinates1: [number, number],\n  coordinates2: [number, number],\n  units?: Units,\n): number {\n  const dLat = degreesToRadians(coordinates2[1] - coordinates1[1]);\n  const dLon = degreesToRadians(coordinates2[0] - coordinates1[0]);\n  const lat1 = degreesToRadians(coordinates1[1]);\n  const lat2 = degreesToRadians(coordinates2[1]);\n  const a =\n    Math.pow(Math.sin(dLat / 2), 2) +\n    Math.pow(Math.sin(dLon / 2), 2) * Math.cos(lat1) * Math.cos(lat2);\n\n  return radiansToLength(\n    2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a)),\n    (units = 'meters'),\n  );\n}\n\nexport function project(lnglat: [number, number]) {\n  const d = Math.PI / 180;\n  const max = 85.0511287798;\n  const earthRadius = 6378137;\n  const lat = Math.max(Math.min(max, lnglat[1]), -max);\n  const sin = Math.sin(lat * d);\n  const x = earthRadius * lnglat[0] * d;\n  const y = (earthRadius * Math.log((1 + sin) / (1 - sin))) / 2;\n\n  return [x, y];\n}\n\nexport function padBounds(b: IBounds, bufferRatio: number): IBounds {\n  const heightBuffer = Math.abs(b[1][1] - b[0][1]) * bufferRatio;\n  const widthBuffer = Math.abs(b[1][0] - b[0][0]) * bufferRatio;\n\n  return [\n    [b[0][0] - widthBuffer, b[0][1] - heightBuffer],\n    [b[1][0] + widthBuffer, b[1][1] + heightBuffer],\n  ];\n}\n/**\n * b1 包含 b2 返回 true 否则false\n * @param b1 bounds1\n * @param b2 bounds2\n */\nexport function boundsContains(b1: IBounds, b2: IBounds): boolean {\n  return (\n    b1[0][0] <= b2[0][0] &&\n    b1[0][1] <= b2[0][1] &&\n    b1[1][0] >= b2[1][0] &&\n    b1[1][1] >= b2[1][1]\n  );\n}\n/**\n * bbox 转换为Bounds\n * @param b1 bbox\n *\n */\nexport function bBoxToBounds(b1: BBox): IBounds {\n  return [\n    [b1[0], b1[1]],\n    [b1[2], b1[3]],\n  ];\n}\n\nexport function normalize(v: Point) {\n  const len = calDistance(v, [0, 0]);\n  return [v[0] / len, v[1] / len];\n}\n\nexport function calDistance(p1: Point, p2: Point) {\n  return Math.sqrt(Math.pow(p1[0] - p2[0], 2) + Math.pow(p1[1] - p2[1], 2));\n}\n\nfunction dotMul(v1: Point, v2: Point) {\n  return v1[0] * v2[0] + v1[1] * v2[1];\n}\n\nfunction getMod(v: Point) {\n  return Math.sqrt(v[0] * v[0] + v[1] * v[1]);\n}\n\nexport function calAngle(v1: Point, v2: Point) {\n  return (\n    (Math.acos(dotMul(v1, v2) / (getMod(v1) * getMod(v2))) * 180) / Math.PI\n  );\n}\n\nexport function getAngle(v1: Point, v2: Point) {\n  // if(v2[0] < 0) {\n  //   return calAngle(v1, v2) + 180\n  // } else {\n  //   return calAngle(v1, v2)\n  // }\n\n  if (v2[0] > 0) {\n    if (v2[1] > 0) {\n      // 1\n      return 90 - (Math.atan(v2[1] / v2[0]) * 180) / Math.PI;\n    } else {\n      // 2\n      return 90 + (Math.atan(-v2[1] / v2[0]) * 180) / Math.PI;\n    }\n  } else {\n    if (v2[1] < 0) {\n      // 3\n      return 180 + (90 - (Math.atan(v2[1] / v2[0]) * 180) / Math.PI);\n    } else {\n      // 4\n      return 270 + (Math.atan(v2[1] / -v2[0]) * 180) / Math.PI;\n    }\n  }\n}\ninterface IPathPoint {\n  start: Point;\n  end: Point;\n  dis: number;\n  rotation: number;\n  duration: number;\n}\n\nexport function flow(coords: Point[], time: number = 100) {\n  if (!coords || coords.length < 2) {\n    return;\n  }\n  const originVec2: Point = [0, 1];\n  let totalDis = 0;\n  const path: IPathPoint[] = [];\n  for (let i = 0; i < coords.length - 1; i++) {\n    const p1: Point = coords[i];\n    const p2: Point = coords[i + 1];\n    const dis = calDistance(p1, p2);\n    totalDis += dis;\n\n    const direct: Point = [p1[0] - p2[0], p1[1] - p2[1]];\n    // const direct: Point = [p2[0] - p1[0], p2[1] - p1[1]];\n\n    let rotation = getAngle(originVec2, direct);\n    if (i > 0) {\n      const lastRotation = path[i - 1].rotation;\n      if (lastRotation - rotation > 360 - lastRotation + rotation) {\n        rotation = rotation + 360;\n      }\n    }\n\n    path.push({\n      start: p1,\n      end: p2,\n      dis,\n      rotation,\n      duration: 0,\n    });\n  }\n  path.map((point) => {\n    point.duration = time * (point.dis / totalDis);\n  });\n  return path;\n}\n"],"file":"geo.js"}